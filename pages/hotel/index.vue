<template>
  <div class="hotel">
    <el-row>
      <p class="hotel-header">
        é…’åº— >
        <span>{{form.name}}</span>é…’åº—é¢„è®¢
      </p>
    </el-row>
    <el-row>
      <el-form>
        <el-autocomplete
          :fetch-suggestions="queryDepartSearch"
          v-model="form.cityname"
          placeholder="ç›®çš„åœ°"
          @select="handleDepartSelect"
          style="margin-right:15px"
        ></el-autocomplete>

        <el-date-picker
          v-model="value1"
          @change="shijiancufa"
          type="daterange"
          range-separator="è‡³"
          start-placeholder="å¼€å§‹æ—¥æœŸ"
          end-placeholder="ç»“æŸæ—¥æœŸ"
        ></el-date-picker>

        <el-select v-model="form.region" placeholder="äººæ•°æœªå®š">
          <el-option value>
            <span>æ¯é—´</span>
            <span>
              <el-dropdown :hide-on-click="false">
                <span class="el-dropdown-link" style="display:inlin-block;">
                  ä¸‹æ‹‰èœå•
                  <i class="el-icon-arrow-down el-icon--right"></i>
                </span>
                <el-dropdown-menu slot="dropdown" style="  float: right;">
                  <el-dropdown-item>é»„é‡‘ç³•</el-dropdown-item>
                  <el-dropdown-item>ç‹®å­å¤´</el-dropdown-item>
                  <el-dropdown-item>èºè›³ç²‰</el-dropdown-item>
                </el-dropdown-menu>
              </el-dropdown>
              <el-dropdown :hide-on-click="false">
                <span class="el-dropdown-link" style="display:inlin-block;">
                  ä¸‹æ‹‰èœå•
                  <i class="el-icon-arrow-down el-icon--right"></i>
                </span>
                <el-dropdown-menu slot="dropdown" style="  float: right;">
                  <el-dropdown-item>é»„é‡‘ç³•</el-dropdown-item>
                  <el-dropdown-item>ç‹®å­å¤´</el-dropdown-item>
                  <el-dropdown-item>èºè›³ç²‰</el-dropdown-item>
                </el-dropdown-menu>
              </el-dropdown>
            </span>
            <hr />
          </el-option>
        </el-select>
        <el-button type="primary" style="margin-left:30px" @click="chakanjiage">æŸ¥çœ‹ä»·æ ¼</el-button>
      </el-form>
    </el-row>
    <el-row>
      <el-row class="chengshixiangqing">
        <el-row style="width:600px; float: left;" class="mianshu">
          <el-col class="quyu">
            åŒºåŸŸ:
            <el-col class="quyu-neirong">
              <span v-for="(item,index) in jingqu" :key="index">{{item.name}}</span>
            </el-col>
          </el-col>
          <el-col class="gonglue">
            æ”»ç•¥:
            <el-col
              class="gonglue-neirong"
            >åŒ—äº¬ï¼Œä½ æƒ³è¦çš„éƒ½èƒ½åœ¨è¿™æ‰¾åˆ°ã€‚åšå¤é€šä»Šï¼Œå…¼å®¹å¹¶è“„ï¼Œå¤©ä¸‹ä¸€åŸï¼Œå¦‚æ˜¯å¸éƒ½ã€‚ æ™¯ç‚¹ä»¥æ•…å®«ä¸ºä¸­å¿ƒå‘å››å¤„è¾å°„ï¼›åœ°é“ä¾¿å®œé€šç•…ï¼Œè€Œä¸”è¦†ç›–ç»å¤§å¤šæ•°æ™¯ç‚¹ã€‚ ç”±äºæ—©ä¸Šæœ‰å¤©å®‰é—¨å‡æ——ä»ªå¼ï¼Œæ‰€ä»¥å¤§å¤šæ•°äººé€‰æ‹©åœ¨å¤©å®‰é—¨é™„è¿‘ä½å®¿ã€‚</el-col>
          </el-col>
          <el-col class="junjia">
            <span>å‡ä»·:</span>
            <el-col class="junjia-neirong">
              <el-tooltip class="tishi" content="ç­‰çº§è¯„å®šæ˜¯é’ˆå¯¹æˆ¿ä»·ï¼Œè®¾æ–½å’ŒæœåŠ¡ç­‰å„æ–¹é¢æ°´å¹³çš„ç»¼åˆè¯„ä¼°" placement="top-start">
                <el-button>
                  <span>ğŸ’—ğŸ’—ğŸ’—ï¿¥332</span>
                </el-button>
              </el-tooltip>
              <el-tooltip class="tishi" content="ç­‰çº§è¯„å®šæ˜¯é’ˆå¯¹æˆ¿ä»·ï¼Œè®¾æ–½å’ŒæœåŠ¡ç­‰å„æ–¹é¢æ°´å¹³çš„ç»¼åˆè¯„ä¼°" placement="top-start">
                <el-button>
                  <span>ğŸ’—ğŸ’—ğŸ’—ğŸ’—ï¿¥521</span>
                </el-button>
              </el-tooltip>
              <el-tooltip class="tishi" content="ç­‰çº§è¯„å®šæ˜¯é’ˆå¯¹æˆ¿ä»·ï¼Œè®¾æ–½å’ŒæœåŠ¡ç­‰å„æ–¹é¢æ°´å¹³çš„ç»¼åˆè¯„ä¼°" placement="top-start">
                <el-button>
                  <span>ğŸ’—ğŸ’—ğŸ’—ğŸ’—ğŸ’—ï¿¥768</span>
                </el-button>
              </el-tooltip>
            </el-col>
            <el-tooltip class="tishi" content="ç­‰çº§è¯„ä»·ç”±å¹³æ—¥ä»·æ ¼è®¡ç®—å¾—å‡ºï¼ŒèŠ‚å‡æ—¥ä»·æ ¼ä¼šæœ‰ä¸Šæµ®" placement="top-start">
              <el-button>?</el-button>
            </el-tooltip>
          </el-col>
        </el-row>
        <el-row class="hotelditu"></el-row>
      </el-row>
      <el-row type="flex" class="guolv">
        <el-col :span="6">
          <div class="block">
            <span>ä»·æ ¼</span>
            <i>0-{{value}}</i>
            <el-slider v-model="value" :max="zuidazhi" style="margin:0 20px"></el-slider>
          </div>
        </el-col>
        <el-col :span="5" class="dengji" >
          <p>ä½å®¿ç­‰çº§</p>
          <el-dropdown class="dengji-xiala" >
            <span class="el-dropdown-link"  >
              {{radio}}
              <i class="el-icon-arrow-down el-icon--right" style="margin-left:120px"></i>
            </span>
            <el-dropdown-menu slot="dropdown" >
              <el-dropdown-item style="width:130px">
                <el-radio v-model="radio" label="1æ˜Ÿ">1æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio" label="2æ˜Ÿ">2æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio" label="3æ˜Ÿ">3æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio" label="4æ˜Ÿ">4æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio" label="5æ˜Ÿ">5æ˜Ÿ</el-radio>
              </el-dropdown-item>
            </el-dropdown-menu>
          </el-dropdown>
        </el-col>
        <el-col :span="5" class="leixing">
          <p>ä½å®¿ç±»å‹</p>
          <el-dropdown class="leixing-xiala">
            <span class="el-dropdown-link">
              {{radio2}}
              <i class="el-icon-arrow-down el-icon--right" style="margin-left:120px"></i>
            </span>
            <el-dropdown-menu slot="dropdown">
              <el-dropdown-item style="width:130px">
                <el-radio v-model="radio2" label="ç»æµå‹">ç»æµå‹</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio2" label="èˆ’é€‚å‹">èˆ’é€‚å‹</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio2" label="é«˜æ¡£å‹">é«˜æ¡£å‹</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio2" label="è±ªåå‹">è±ªåå‹</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio2" label="åº¦å‡æ‘">åº¦å‡æ‘</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio2" label="å…¬å¯“å¼é…’åº—">å…¬å¯“å¼é…’åº—</el-radio>
              </el-dropdown-item>
            </el-dropdown-menu>
          </el-dropdown>
        </el-col>
        <el-col :span="4" class="sheshi">
          <p>é…’åº—è®¾æ–½</p>
          <el-dropdown class="sheshi-xiala">
            <span class="el-dropdown-link">
              {{radio3}}
              <i class="el-icon-arrow-down el-icon--right" style="margin-left:90px"></i>
            </span>
            <el-dropdown-menu slot="dropdown">
              <el-dropdown-item style="width:130px">
                <el-radio v-model="radio3" label="wifi">wifi</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio3" label="çƒ­æ°´å£¶">çƒ­æ°´å£¶</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio3" label="å¹é£æœº">å¹é£æœº</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio3" label="å¤–å¸å…‘æ¢æœåŠ¡">å¤–å¸å…‘æ¢æœåŠ¡</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio3" label="æ´—è¡£æœåŠ¡">æ´—è¡£æœåŠ¡</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio3" label="ç”µæ¢¯">ç”µæ¢¯</el-radio>
              </el-dropdown-item>
            </el-dropdown-menu>
          </el-dropdown>
        </el-col>
        <el-col :span="4" class="pinpai">
          <p>é…’åº—å“ç‰Œ</p>
          <el-dropdown class="pinpai-xiala">
            <span class="el-dropdown-link">
              {{radio4}}
              <i class="el-icon-arrow-down el-icon--right" style="margin-left:90px"></i>
            </span>
            <el-dropdown-menu slot="dropdown">
              <el-dropdown-item style="width:130px">
                <el-radio v-model="radio4" label="1æ˜Ÿ">1æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio4" label="2æ˜Ÿ">2æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio4" label="3æ˜Ÿ">3æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio4" label="4æ˜Ÿ">4æ˜Ÿ</el-radio>
              </el-dropdown-item>
              <el-dropdown-item>
                <el-radio v-model="radio4" label="5æ˜Ÿ">5æ˜Ÿ</el-radio>
              </el-dropdown-item>
            </el-dropdown-menu>
          </el-dropdown>
        </el-col>
      </el-row>
    </el-row>
    <Jiudian :data='this.jiudian'/>
  </div>
</template>

<script>
import moment from "moment";
import Jiudian from "@/components/hotel/jiudian";
export default {
  data() {
    return {
      value: 4000,
      value1: "",
      // max:4000,
      radio: "ä¸é™",
      radio2: "ä¸é™",
      radio3: "ä¸é™",
      radio4: "ä¸é™",
      zuidazhi: 4000,
      jiudianmingzi:'',
      form: {
        name: "å—äº¬å¸‚",
        cityname: "",
        date1: "",
        region: "",
        id: "",
        enterTime: "",
        leftTime: ""
      },
      jingqu: [],
      jiudian:{
        jiudianxinxi:[],
        total:""
      }
    };
  },
  components: {
    Jiudian
  },
  mounted() {
    this.$axios({
        url: "/hotels",
        // params: { city: this.form.id }
      }).then(res=>{
        console.log(res);
        const {data} = res
        this.jiudian=data
      })
    this.jingquxuanran();
  },
  methods: {
    // ç‚¹å‡»ç›®çš„åœ°æ—¶è§¦å‘
    queryDepartSearch(value, cb) {
      //   console.log(value);
      if (!value.trim()) {
        cb([]);
        return;
      }
      this.$axios({
        url: "/cities",
        params: { name: value }
      }).then(res => {
        console.log(res);
        const { data } = res.data;
        this.jingqu = data[0].scenics;
        const newData = data.map(v => {
          return {
            ...v,
            value: v.name
          };
        });
        cb(newData);
      });
    },
    // æ™¯åŒºæ¸²æŸ“
    jingquxuanran() {
      this.$axios({
        url: "/cities",
        params: { name: this.form.name }
      }).then(res => {
        // console.log(res);
        const { data } = res.data;
        this.jingqu = data[0].scenics;
      });
    },
    // é€‰æ‹©ç›®çš„åœ°æ—¶è§¦å‘
    handleDepartSelect(value, cb) {
      console.log(value);
      this.form.name = value.value;
      this.form.id = value.id;
      this.$axios({
        url: "/hotels",
        params: { city: this.form.id }
      }).then(res => {
        console.log(res);
        const {data} = res.data
        this.$router.push(`?city=${this.form.id}`);
       
      });
    },
    // æŸ¥çœ‹ä»·æ ¼
    chakanjiage() {
      // this.$router.push(
      //   `?city=${this.form.id}&enterTime=${this.form.enterTime}&leftTime=${this.form.leftTime}`
      // );
      let paramsArr = [
        ["city", this.form.id],
        ["enterTime", this.form.enterTime],
        ["startTime", this.form.startTime]
      ];
      paramsArr = paramsArr.reduce((res, o) => {
        if (o[1]) {
          res.push(o[0] + "=" + o[1]);
        }
        return res;
      }, []);

      const paramsStr = paramsArr.join("&");
      this.$router.push(paramsStr ? ('?' + paramsStr) : '');
    },
    // é€‰æ‹©æ—¶é—´æ—¶è§¦å‘
    shijiancufa(value) {
      console.log(value[0]);
      this.form.enterTime = moment(value[0]).format("YYYY-MM-DD");
      this.form.leftTime = moment(value[1]).format("YYYY-MM-DD");
      // console.log( this.form.enterTime ,this.form.enterTime2 );
    }
  }
};
</script>

<style lang="less" scoped>
.hotel {
  font-size: 14px;
  font-weight: 400;
  color: #606266;
  width: 1000px;
  margin: 0 auto;
}

.hotel-header {
  height: 60px;
  line-height: 60px;
}
.hotelditu {
  height: 260px;
  background-color: red;
  width: 400px;
  float: right;
}
.chengshixiangqing {
  margin-bottom: 20px;
  margin-top: 20px;
}
.quyu,
.gonglue,
.junjia {
  margin-bottom: 30px;
}
.junjia {
  position: relative;
}
.junjia > .tishi {
  width: 15px;
  padding: 0;
  height: 15px;
  text-align: center;
  line-height: 15px;
  background-color: #999;
  border-radius: 50%;
  position: absolute;
  left: 30px;
  top: -10px;
  color: #eee;
}
.quyu-neirong,
.gonglue-neirong {
  width: 500px;
  float: right;
  margin-right: 50px;
}
.quyu-neirong span {
  margin-right: 15px;
}
.junjia-neirong {
  width: 500px;
  float: right;
  margin-right: 60px;
}
.junjia-neirong .tishi {
  padding: 0;
  border: none;
  padding: 0px 10px;
}
.block,
.dengji,
.leixing,
.sheshi {
  height: 70px;
  margin: 5px 0;
  border-right: 1px solid #ccc;
}
.pinpai {
  height: 70px;
  margin: 5px 0;
}
.block span {
  display: inline-block;
  padding: 10px 0 0 20px;
}
.block i {
  margin-left: 120px;
}
.guolv {
  border: 1px solid #ccc;
  margin-bottom: 30px;
}
.dengji p,
.dengji .el-dropdown-link,
.leixing p,
.leixing-xiala,
.sheshi p,
.sheshi-xiala,
.pinpai p,
.pinpai-xiala {
  margin: 10px 0 0 20px;
}
.dengji-xiala,
.leixing-xiala,
.sheshi-xiala,
.pinpai-xiala {
  margin-top: 18px;
}
</style>
  